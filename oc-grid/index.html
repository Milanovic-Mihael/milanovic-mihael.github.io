---
layout: default
title: Character Gallery | MilanovicMihael
---

<link rel="stylesheet" href="{{ '/assets/css/oc-grid.css' | relative_url }}">

<div class="filters">
  <button class="filter-btn" data-filter="all">All</button>
  {% assign universes = "Strength Seeker,Progenies,The Long Midnight" | split: "," %}
  {% for u in universes %}
  <button class="filter-btn" data-filter="{{ u | escape }}">{{ u }}</button>
  {% endfor %}

  <label for="oc-search"
    style="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0;">Search
    characters</label>
  <input type="text" id="oc-search" placeholder="Search characters..." />
</div>

<div class="oc-grid">
  {% assign sorted_ocs = site.ocs | sort: "order" %}
  {% for oc in sorted_ocs %}
  {% unless oc.title == "Terraria: Pendulum" %}

  {% assign protag_class = "" %}
  {% if oc.tags contains "protag" %}
  {% assign protag_class = "protagonist" %}
  {% endif %}

  <div class="oc-card-wrapper" data-universe="{{ oc.universe | escape }}">
    <a class="oc-card {{ protag_class }}" href="{{ oc.url | relative_url }}" data-universe="{{ oc.universe | escape }}"
      aria-label="View character: {{ oc.title | escape }}">
      {% if oc.tags contains "protag" %}
      <span class="protagonist-icon">ðŸœ„</span>
      {% endif %}
      <div class="oc-thumb">
        {% if oc.featured %}
        <img src="{{ oc.featured | relative_url }}" alt="{{ oc.title | escape }}" loading="lazy">
        {% endif %}
      </div>

      <div class="oc-meta">
        <div class="title-wrapper">
          <h2>{{ oc.title }}</h2>
        </div>
        {% if oc.species %}<p class="muted">{{ oc.species }}</p>{% endif %}
        {% if oc.universe %}<span class="tag">{{ oc.universe }}</span>{% endif %}
      </div>
    </a>

    <img class="frame" alt="">
  </div>

  {% endunless %}
  {% endfor %}

  <p class="no-ocs" style="display:none;">No one here... check your search...</p>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const buttons = document.querySelectorAll('.filter-btn');
    const wrappers = document.querySelectorAll('.oc-card-wrapper');
    const searchInput = document.getElementById('oc-search');
    const noMessage = document.querySelector('.no-ocs');

    function setActiveButton(filterName) {
      buttons.forEach(b => b.classList.toggle('active', b.dataset.filter === filterName));
    }

    function filterOCs() {
      const query = searchInput.value.toLowerCase();
      const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;
      let anyVisible = false;

      wrappers.forEach(wrapper => {
        const title = wrapper.querySelector('h2').textContent.toLowerCase();
        const speciesElem = wrapper.querySelector('.muted');
        const species = speciesElem ? speciesElem.textContent.toLowerCase() : '';
        const universe = wrapper.dataset.universe;

        const matchesSearch = title.includes(query) || species.includes(query);
        const matchesFilter = activeFilter === 'all' || universe === activeFilter;
        const isVisible = matchesSearch && matchesFilter;

        wrapper.style.display = isVisible ? '' : 'none';
        if (isVisible) anyVisible = true;
      });
      noMessage.style.display = anyVisible ? 'none' : '';
    }

    // Efficiency: Event listener refactoring
    buttons.forEach(btn => {
      btn.addEventListener('click', () => {
        const filter = btn.dataset.filter;
        setActiveButton(filter);
        filterOCs();
        sessionStorage.setItem('presetFilter', filter);
        const newUrl = filter === 'all' ? window.location.pathname : `?universe=${encodeURIComponent(filter)}`;
        window.history.replaceState({ path: newUrl }, '', newUrl);
      });
    });

    searchInput.addEventListener('input', filterOCs);

    // Frame logic
    wrappers.forEach(wrapper => {
      const frame = wrapper.querySelector('.frame');
      const frames = {
        "Strength Seeker": "/assets/images/frames/frame_strs.webp",
        "Progenies": "/assets/images/frames/frame_prog.webp",
        "The Long Midnight": "/assets/images/frames/frame_midnight.webp",
        "Misc": "/assets/images/frames/frame_misc.webp"
      };
      frame.src = frames[wrapper.dataset.universe] || "";
    });

    // Tooltip efficiency
    const tooltip = document.createElement('div');
    tooltip.className = 'protagonist-tooltip';
    tooltip.textContent = 'This character is the protagonist';
    document.body.appendChild(tooltip);

    document.querySelectorAll('.protagonist-icon').forEach(icon => {
      icon.addEventListener('mouseenter', () => {
        const rect = icon.getBoundingClientRect();
        Object.assign(tooltip.style, {
          left: `${rect.left + rect.width / 2}px`,
          top: `${rect.top - 8}px`,
          transform: 'translate(-50%, -100%)'
        });
        tooltip.classList.add('show');
      });
      icon.addEventListener('mouseleave', () => tooltip.classList.remove('show'));
    });

    window.addEventListener('scroll', () => tooltip.classList.remove('show'));

    function initFilter() {
      const urlParams = new URLSearchParams(window.location.search);
      const finalFilter = urlParams.get('universe') || sessionStorage.getItem('presetFilter') || 'all';
      setActiveButton(finalFilter);
      filterOCs();
      document.querySelector('.oc-grid').classList.add('loaded');
    }

    initFilter();
    window.addEventListener('pageshow', initFilter);
  });
</script>